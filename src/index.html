<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <title>Vanilla JavaScript App!</title>
  <script src="https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/dist/jwt-decode.min.js"></script>
</head>

<body>
  <main>
    <h1>Vanilla JavaScript App</h1>
  </main>
  <script>
    async function validateIdToken(idToken) {
        // Azure AD B2CのOpenID設定を取得します
        const response = await fetch('https://onoderacorp.b2clogin.com/onoderacorp.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=B2C_1A_REDIRECTJUDGMENT_SIGNUP_SIGNIN');
        const openidConfig = await response.json();
        const keys = openidConfig.jwks_uri;

        // id_tokenをデコードします
        const decodedToken = jwt_decode(idToken);

        // ここで公開鍵とデコードしたトークンを使用して署名を検証するロジックを追加します
        // ブラウザでは署名の検証が難しいため、通常はサーバーサイドで行います

        return decodedToken;
    }

    // URLからid_tokenを取得します
    const idToken = 'your-id-token-from-url';
    validateIdToken(idToken)
        .then(decodedToken => {
            console.log(decodedToken);
        })
        .catch(err => {
            console.error('Token validation failed', err);
        });
  </script>
</body>

</html>